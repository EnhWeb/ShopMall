#            ShopMall与Lzx-Blog诞生

## 前言

ShopMall：一直想做一个比较完美的购物网站，索性就延续毕业设计的时候做“**广西民族师范学院超市网站**”的想法吧。做一个ShopMall商城网站。把自己所学的技术都运用上去，看看效果如何。从零开始.NET Core的ShopMall就开始了。

lzx-Blog：同期想做的项目还有属于自己的博客网站，2019年4月份做了一份.NET的了，但是随着技术不断更新，索性也一起尬玩运用.NET Core进行编写。

# 第一章、 ShopMall 技术方案

## 1.1 ShopMall所需项目

### 1.1.1 接口WebApi

###  1.1.2 Uni-App解决移动端（h5、小程序、IOS、Android）

### 1.1.3 web_PC端

### 1.1.4 IdentityServerWeb 认证端

### 1.1.5 Signalr实时功能推送端

## 1.2 ShopMall数据库字段设计

  系统实际涉及的数据量约为百万级，从保证系统的流畅度和成本等各方面因素考虑。平台数据库设计，如下所示：

 #### **省市县表**  

| 数据表中文名称 | 省市县表                  | 修改说明       | 调整         |          |          |
| -------------- | ------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | province_city_county      |                |              |          |          |
| 功能简述       |                           |                |              |          |          |
| **序号**       | **字段中文名**            | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id                      | id             | int          |          | PK       |
| 2              | 名称                      | name           | varchar      | 100      |          |
| 3              | 父级ID                    | pid            | int          |          |          |
| 4              | 1表示省，2表示市，3表示县 | ptype          | int          |          |          |
| 5              | 编码                      | code           | varchar      | 20       |          |
| 6              | 状态，默认为1             | status         | int          |          |          |

 #### **地址表**

| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_address   |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                | id             | int          |          | PK       |
| 2              | 收货人         | csName         | varchar      | 10       |          |
| 3              | 收货人         | csMobilePhone  | varchar      | 12       |          |
| 4              |                | provinceID     | int          |          |          |
| 5              |                | cityID         | int          |          |          |
| 6              | 区县ID         | areaID         | int          |          |          |

 #### **广告表**



| 数据表中文名称 |                                                            | 修改说明       | 调整         |          |          |
| -------------- | ---------------------------------------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_advertisement                                         |                |              |          |          |
| 功能简述       |                                                            |                |              |          |          |
| **序号**       | **字段中文名**                                             | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                                                            | id             | int          |          | PK       |
| 2              |                                                            | spid           | int          |          |          |
| 3              | 广告标题                                                   | advName        | varchar      | 20       |          |
| 4              | 位置编号（如：移动端mobile_index_位置，pc端PC_index_位置） | positionNo     | varchar      | 50       |          |
| 5              | 到期时间                                                   | expirationDate | datetime     |          |          |
| 6              | 注册时间                                                   | creatTime      | datetime     |          |          |

#### **广告图片表**



| 数据表中文名称 |                        | 修改说明       | 调整         |          |          |
| -------------- | ---------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_advertisement_img |                |              |          |          |
| 功能简述       |                        |                |              |          |          |
| **序号**       | **字段中文名**         | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                        | id             | int          |          | PK       |
| 2              | 广告ID                 | advID          | int          |          |          |
| 3              | 图片路径               | imgUrl         | varchar      | 100      |          |
| 4              | 排序                   | sort           | int          |          |          |

 #### **品牌表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_brand     |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id           | id             | int          |          | PK       |
| 2              | 品牌名称       | bpName         | varchar      | 20       |          |
| 3              | 排序           | sort           | int          |          |          |
| 4              | 只存一级分类   | classID        | int          |          |          |
| 5              | 注册时间       | creatTime      | datetime     |          |          |
| 6              |                | isDel          | bit          |          |          |

 #### **收藏表**



| 数据表中文名称 |                 | 修改说明       | 调整         |          |          |
| -------------- | --------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_collection |                |              |          |          |
| 功能简述       |                 |                |              |          |          |
| **序号**       | **字段中文名**  | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                 | id             | int          |          |          |
| 2              | 商品id          | spid           | int          |          |          |
| 3              |                 | uid            | int          |          |          |
| 4              | 注册时间        | creatTime      | datetime     |          |          |

 #### **订单表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_order     |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 订单ID         | orderID        | int          |          | PK       |
| 2              | 订单号         | orderNo        | varchar      | 100      |          |
| 3              | 第三方订单号   | thirdOrderNo   | varchar      | 100      |          |
| 4              | 手机           | mobilePhone    | varchar      | 12       |          |
| 5              | 地址ID         | addressID      | int          |          |          |
| 6              | 用户ID         | uid            | int          |          |          |

 #### **子订单表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_orderItem |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 子订单表       | orderItemID    | int          |          | PK       |
| 2              | 商品ID         | spid           | int          |          |          |
| 3              | skuID对应sku表 | skuid          | int          |          |          |
| 4              | 订单ID         | orderID        | int          |          |          |
| 5              | 购买数量       | number         | int          |          |          |
| 6              | 价格           | price          | decimal      | 18,2     |          |

 #### **退款表**



| 数据表中文名称 |                                            | 修改说明       | 调整         |          |          |
| -------------- | ------------------------------------------ | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_refund                                |                |              |          |          |
| 功能简述       |                                            |                |              |          |          |
| **序号**       | **字段中文名**                             | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                                            | id             | int          |          | PK       |
| 2              |                                            | uid            | varchar      | 100      |          |
| 3              | 退款编号                                   | refundNo       | varchar      | 100      |          |
| 4              | 订单号                                     | orderNo        | varchar      | 100      |          |
| 5              | 状态（0-正在申请，1申请通过，2申请不通过） | state          | int          |          |          |
| 6              | 退款理由                                   | refundMsg      | varchar      | 100      |          |

#### **购物车表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_shopCar   |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 购物车表id     | id             | int          |          |          |
| 2              | 用户id         | uid            | int          |          |          |
| 3              | 对应表skuid    | skuid          | int          |          |          |
| 4              | 数量           | Number         | int          |          |          |
| 5              | 价格           | Price          | decimal      | 18,2     |          |
| 6              | 注册时间       | creatTime      | datetime     |          |          |

 #### **商品sku表**



| 数据表中文名称 |                  | 修改说明       | 调整         |          |          |
| -------------- | ---------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_sku         |                |              |          |          |
| 功能简述       |                  |                |              |          |          |
| **序号**       | **字段中文名**   | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id             | skuID          | int          |          | PK       |
| 2              | 商品ID           | spid           | int          |          |          |
| 3              | 规格值，ids      | spfvIDs        | varchar      | 200      |          |
| 4              | 对应属性值字符串 | spfvStr        | varchar      | 200      |          |
| 5              |                  | skuImg         | varchar      | 200      |          |
| 6              | 价格             | price          | decimal      | 18,2     |          |

 #### **商品分类表**  



| 数据表中文名称 | 商品分类表       | 修改说明       | 调整         |          |          |
| -------------- | ---------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_sp_class    |                |              |          |          |
| 功能简述       |                  |                |              |          |          |
| **序号**       | **字段中文名**   | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表ID             | id             | int          |          | PK       |
| 2              | 分类名称         | className      | int          |          |          |
| 3              | 轨迹，包括父级id | idList         | varchar      | 200      |          |
| 4              | 父级分类         | fid            | int          |          |          |
| 5              | 排序             | sort           | int          |          |          |
| 6              | 是否删除         | IsDelete       | bit          |          |          |

#### **规格表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spf       |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id           | spfID          | int          |          | PK       |
| 2              | 分类ID         | classID        | int          |          |          |
| 3              | 规格名称       | spfName        | varchar      | 10       |          |
| 4              | 排序           | sort           | int          |          |          |
| 5              | 注册时间       | creatTime      | datetime     |          |          |

 #### **规格值表**



| 数据表中文名称 |                | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spfv      |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id           | spfvID         | int          |          | PK       |
| 2              | 规格值         | spfValue       | varchar      | 20       |          |
| 3              | 对应规格表ID   | spfID          | int          |          |          |
| 4              | 排序           | sort           | int          |          |          |
| 5              | 注册时间       | creatTime      | datetime     |          |          |

#### **商品表**



| 数据表中文名称 |                          | 修改说明       | 调整         |          |          |
| -------------- | ------------------------ | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spu                 |                |              |          |          |
| 功能简述       |                          |                |              |          |          |
| **序号**       | **字段中文名**           | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 商品ID                   | spid           | int          |          | PK       |
| 2              | 商品名称                 | spName         | varchar      | 50       |          |
| 3              | 轨迹，对应所在分类的轨迹 | classIDs       | varchar      | 20       |          |
| 4              | 商品分类id，             | ClassID        | int          |          |          |
| 5              | 品牌ID                   | bpid           | int          |          |          |
| 6              | 平均价格                 | vagPrice       | decimal      | 18,2     |          |

 #### **商品评价表**



| 数据表中文名称 |                   | 修改说明       | 调整         |          |          |
| -------------- | ----------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spu_evaluate |                |              |          |          |
| 功能简述       |                   |                |              |          |          |
| **序号**       | **字段中文名**    | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id              | id             | int          |          | PK       |
| 2              |                   | spid           | int          |          |          |
| 3              |                   | skuid          | int          |          |          |
| 4              | 商品星级          | spStar         | int          |          |          |
| 5              | 商品评价          | spevaluate     | varchar      | 100      |          |
| 6              | 物流星级评价      | shopWl         | int          |          |          |

#### **商品评价图片**



| 数据表中文名称 |                       | 修改说明       | 调整         |          |          |
| -------------- | --------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spu_evaluate_img |                |              |          |          |
| 功能简述       |                       |                |              |          |          |
| **序号**       | **字段中文名**        | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                       | id             | int          |          | PK       |
| 2              | 评价ID                | evaluateID     | int          |          |          |
| 3              | 图片路径              | img            | varchar      | 100      |          |

 #### **评价回复表**



| 数据表中文名称 |                         | 修改说明       | 调整         |          |          |
| -------------- | ----------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_spu_evaluate_reply |                |              |          |          |
| 功能简述       |                         |                |              |          |          |
| **序号**       | **字段中文名**          | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                         | id             | int          |          | PK       |
| 2              | 评价ID                  | evaluateID     | int          |          |          |
| 3              | 回复img                 | econtent       | varchar      | 200      |          |
| 4              | 回复人uid               | replyuid       | int          |          |          |
| 5              | 被回复人                | coveruid       | int          |          |          |
| 6              | 注册时间                | creatTime      | datetime     |          |          |

 #### **用户表**  



| 数据表中文名称 | 用户表                                   | 修改说明       | 调整         |          |          |
| -------------- | ---------------------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_sys_user                            |                |              |          |          |
| 功能简述       |                                          |                |              |          |          |
| **序号**       | **字段中文名**                           | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 用户ID，即表ID                           | uid            | int          |          | PK       |
| 2              | 头像                                     | headPortrait   | varchar      | 100      |          |
| 3              | 登录账号（一般为手机号码，或者邮箱账号） | loginName      | varchar      | 20       |          |
| 4              | 密码随机生成的key                        | passkey        | varchar      | 20       |          |
| 5              | 随机生成的key+密码=passVuale             | passValue      | varchar      | 100      |          |
| 6              | 昵称                                     | nickName       | varchar      | 20       |          |

 #### **交易表**



| 数据表中文名称 |                  | 修改说明       | 调整         |          |          |
| -------------- | ---------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_transaction |                |              |          |          |
| 功能简述       |                  |                |              |          |          |
| **序号**       | **字段中文名**   | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表ID             | id             | int          |          | PK       |
| 2              | 流水号           | transactionNo  | varchar      | 100      |          |
| 3              | 订单号对应交易号 | orderNo        | varchar      | 100      |          |
| 4              | 第三方订单号     | thirdOrderNo   | varchar      | 100      |          |
| 5              | 付款方账号       | payAccount     | varchar      | 100      |          |
| 6              | 收入方账号       | incomeAccount  | varchar      | 100      |          |

 #### **店铺表**



| 数据表中文名称 |                           | 修改说明       | 调整         |          |          |
| -------------- | ------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Shop_user_shop            |                |              |          |          |
| 功能简述       |                           |                |              |          |          |
| **序号**       | **字段中文名**            | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 店铺ID                    | shopid         | int          |          | PK       |
| 2              | 店铺名称                  | shopName       | varchar      | 100      |          |
| 3              | 用户表id                  | uid            | int          |          |          |
| 4              |                           | shopTelephone  | varchar      | 20       |          |
| 5              | 店铺状态（1正常，0-下架） | shopState      | int          |          |          |
| 6              | 排序                      | sort           | int          |          |          |

 

# 第二章、 lzx-Blog 技术方案

## 2.1 lzx-Blog所需项目

### 2.1.1 web端（只做pc端操作，蕴含Signalr技术做一个简单群聊）

### 2.1.2 web端接口

## 2.2 lzx-Blog数据库字段设计



 #### **广告表**  



| 数据表中文名称 | 广告表         | 修改说明       | 调整         |          |          |
| -------------- | -------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Advertisement  |                |              |          |          |
| 功能简述       |                |                |              |          |          |
| **序号**       | **字段中文名** | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id           | id             | int          |          | PK       |
| 2              | 标题           | Title          | varchar      | 64       |          |
| 3              | url广告链接    | Url            | varchar      | 256      |          |
| 4              | 图片路径       | ImgUrl         | varchar      | 200      |          |
| 5              | 备注           | Remark         | varchar      | 200      |          |
| 6              | 创建时间       | Createdate     | datetime     |          |          |

 #### **博文评论表**  



| 数据表中文名称 | 博文评论表                          | 修改说明       | 调整         |          |          |
| -------------- | ----------------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | ArticleComment                      |                |              |          |          |
| 功能简述       |                                     |                |              |          |          |
| **序号**       | **字段中文名**                      | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              |                                     | id             | int          |          | PK       |
| 2              | 评论人                              | uid            | int          |          |          |
| 3              | 当为第一当前留言为0，否则存储@人uid | reply          | int          |          |          |
| 4              | 父级ID，如为0则为一级评论           | fid            | int          |          |          |
| 5              | 文章ID                              | articleID      | int          |          |          |
| 6              | uid的头像                           | headPortrait   | varchar      | 100      |          |

 #### **博客表**  



| 数据表中文名称 | 博客表                | 修改说明       | 调整         |          |          |
| -------------- | --------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | BlogArticle           |                |              |          |          |
| 功能简述       |                       |                |              |          |          |
| **序号**       | **字段中文名**        | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id                  | id             | int          |          | PK       |
| 2              | 创建者昵称            | nickName       | varchar      | 20       |          |
| 3              | 创建者、对应用户表uid | uid            | int          |          |          |
| 4              |                       | title          | varchar      | 50       |          |
| 5              | 分类id                | categoryId     | int          |          |          |
| 6              | 内容                  | bcontent       | text         |          |          |

#### **留言表** 

 

| 数据表中文名称 | 留言表                                 | 修改说明       | 调整         |          |          |
| -------------- | -------------------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | LeaveMsg                               |                |              |          |          |
| 功能简述       |                                        |                |              |          |          |
| **序号**       | **字段中文名**                         | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表ID                                   | id             | int          |          | PK       |
| 2              | 留言人                                 | uid            | int          |          |          |
| 3              | 当为第一当前留言为0，否则存储回复人uid | reply          | int          |          |          |
| 4              | 父级ID，如为0则为一级留言              | fid            | int          |          |          |
| 5              | uid的头像                              | headPortrait   | varchar      | 100      |          |
| 6              | 内容                                   | bcontent       | text         |          |          |

 #### **系统日志表**  



| 数据表中文名称 | 系统日志表               | 修改说明       | 调整         |          |          |
| -------------- | ------------------------ | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Sys_Log                  |                |              |          |          |
| 功能简述       |                          |                |              |          |          |
| **序号**       | **字段中文名**           | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表ID                     | id             | int          |          | PK       |
| 2              | 记录类型(1-登录，2-注册) | logType        | int          |          |          |
| 3              | 创建时间                 | CreateTime     | datetime     |          |          |
| 4              | 描述                     | bcontent       | varchar      | 50       |          |

 #### **用户表**  



| 数据表中文名称 | 用户表                                   | 修改说明       | 调整         |          |          |
| -------------- | ---------------------------------------- | -------------- | ------------ | -------- | -------- |
| 数据表英文名称 | Sys_User                                 |                |              |          |          |
| 功能简述       |                                          |                |              |          |          |
| **序号**       | **字段中文名**                           | **字段英文名** | **数据类型** | **宽度** | **约束** |
| 1              | 表id                                     | uid            | int          |          | PK       |
| 2              | 头像                                     | headPortrait   | varchar      | 100      |          |
| 3              | 登录账号（一般为手机号码，或者邮箱账号） | loginName      | varchar      | 20       |          |
| 4              | 密码随机生成的key                        | passkey        | varchar      | 20       |          |
| 5              | 1-男，2-女                               | sex            | int          |          |          |
| 6              | 随机生成的key+密码=passVuale             | passValue      | varchar      | 100      |          |

 
